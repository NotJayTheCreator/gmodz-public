WeaponLoot = {}
BasicLoot = {}

WeaponLoot["rp_stalker_new"] = {Vector(-1625, -11073, -640), Vector(-1324, -12714, -640), Vector(-1517, -13119, -574), Vector(-1804, -13114, -574), Vector(-3425, -12210, -512), Vector(-3998, -11369, -512), Vector(-3140, -11289, -1024), Vector(-3648, -11584, -1024), Vector(-3200, -11392, -380), Vector(-7750, -12902, -1008), Vector(-6880, -12621, -1008), Vector(-5414, -12392, -1008), Vector(-4712, -12902, -1008), Vector(-11486, -11855, -576), Vector(-11967, -11073, -638), Vector(-12223, -11007, -638), Vector(-12223, -10624, -638), Vector(-12096, -10530, -638), Vector(-11610, -11845, -576), Vector(-11601, -11287, -824), Vector(-11478, -11312, -824), Vector(-11448, -11708, -824), Vector(-11716, -11530, -952), Vector(-12004, -11371, -952), Vector(-11750, -11383, -952), Vector(-12511, -7902, -512), Vector(-12376, -7970, -896), Vector(-12915, -7790, -864), Vector(-8394, -6554, -222), Vector(-8232, -5586, -244), Vector(-5971, -3209, -192), Vector(-5688, -4178, -256), Vector(-5856, -4562, -256), Vector(-5688, -4424, -256), Vector(-5688, -4435, -128), Vector(-5725, -3939, -128), Vector(-5505, -3328, -216), Vector(-5137, -6017, -160), Vector(-5045, -6881, -176), Vector(-4674, -6602, -176), Vector(-4683, -6808, -176), Vector(-4666, -6700, -48), Vector(-4996, -6889, -48), Vector(-2222, -4567, -124), Vector(-2762, -4128, -128), Vector(-2591, -4812, -128), Vector(-2218, -4829, -384), Vector(-2232, -3398, -320), Vector(-2941, -3112, -384), Vector(-2078, -2020, -384), Vector(-2078, -1822, -384), Vector(-578, -1856, -768), Vector(-232, -1518, -896), Vector(-646, -1513, -896), Vector(51, -954, -768), Vector(726, -1377, -768), Vector(699, -3196, -768), Vector(576, -3708, -768), Vector(86, -3615, -768), Vector(-714, -272, 256), Vector(-451, -834, 128), Vector(-425, -663, 0), Vector(-479, -4210, 32), Vector(-697, -4160, 32), Vector(-345, -5014, 32), Vector(-512, -4096, 176), Vector(-238, -3262, 527), Vector(-2601, -3624, 0), Vector(-2665, -2918, 0), Vector(-2657, -2632, 0), Vector(-2340, -2796, 256), Vector(-2711, -2932, 256), Vector(-2715, -2596, 256), Vector(-513, 1534, 16), Vector(255, 2558, 16), Vector(-8984, 5008, -240), Vector(-8797, 4952, -112), Vector(-8782, 4626, -112), Vector(-5087, 12121, 18), Vector(-4787, 11960, 18), Vector(1553, 5994, -256), Vector(1892, 5884, -256), Vector(679, 6437, -240), Vector(990, 6624, -240), Vector(1038, 5834, 16), Vector(1046, 5433, 16), Vector(7090, 4991, -624), Vector(7432, 3327, -688), Vector(7808, 3288, -680), Vector(7806, 3465, -680), Vector(8688, 3106, 256), Vector(8689, 2910, 256), Vector(8594, 2957, 224), Vector(7840, 2800, -512), Vector(8517, 2884, -470), Vector(7844, 3019, -512), Vector(8765, 3368, -512), Vector(8784, 3367, -336), Vector(8233, 2977, -320), Vector(11179, 13236, -384), Vector(10809, 13769, -392), Vector(10673, 13752, -392), Vector(10195, 13370, -384), Vector(10021, 13357, -384), Vector(11557, 12839, -640), Vector(12104, 12760, -640), Vector(13034, 13823, -672), Vector(13883, 14031, -640), Vector(13529, 12309, -640), Vector(14094, 13503, -384), Vector(13890, 14193, -384), Vector(8415, -2113, -512), Vector(7878, -2249, -383), Vector(8499, -2226, -383), Vector(8486, -3778, -368), Vector(8212, -3283, -240), Vector(8015, -3779, -240), Vector(8653, -3389, -240), Vector(9007, -3904, -240), Vector(8654, -3784, -112), Vector(9042, -3911, 0), Vector(7358, -3906, 0), Vector(10554, -8574, 0), Vector(8897, -8568, 0), Vector(9045, -10359, -512), Vector(9337, -11104, -512), Vector(10459, -10375, -256)}
BasicLoot["rp_stalker_new"] = {Vector(-1351, -12466, -606), Vector(-1309, -12238, -606), Vector(-1396, -12238, -606), Vector(-1349, -12124, -640), Vector(-1624, -11263, -592), Vector(-3439, -10856, -588), Vector(-3884, -11810, -633), Vector(-3612, -11290, -640), Vector(-4061, -11295, -640), Vector(-4068, -11743, -1024), Vector(-3742, -11294, -1024), Vector(-3150, -11744, -1024), Vector(-7327, -12560, -448), Vector(-8030, -12560, -448), Vector(-8021, -12389, -1008), Vector(-7798, -12772, -1008), Vector(-7272, -12682, -1008), Vector(-4867, -12394, -1008), Vector(-4693, -12399, -1008), Vector(-11587, -10836, -640), Vector(-11530, -10968, -640), Vector(-11549, -11555, -448), Vector(-11429, -11555, -448), Vector(-11987, -11436, -448), Vector(-11807, -11427, -576), Vector(-11486, -11855, -576), Vector(-11421, -11513, -952), Vector(-11416, -11293, -952), Vector(-11997, -11776, -952), Vector(-12342, -8410, -512), Vector(-13136, -8159, -512), Vector(-13060, -7555, -491), Vector(-12950, -7964, -848), Vector(-12830, -7963, -848), Vector(-13145, -7966, -848), Vector(-11736, -7971, -896), Vector(-11760, -7714, -896), Vector(-8400, -7232, -304), Vector(-8262, -7232, -304), Vector(-8093, -7252, -304), Vector(-8230, -7521, -304), Vector(-8601, -5595, -236), Vector(-8604, -5347, -236), Vector(-7923, -4639, -244), Vector(-8287, -4623, -244), Vector(-8513, -4809, -244), Vector(-8290, -4543, -244), Vector(-8287, -4430, -244), Vector(-8514, -4249, -244), Vector(-8283, -4286, -244), Vector(-6053, -3934, -128), Vector(-6101, -4137, -128), Vector(-6101, -4372, -256), Vector(-5505, -3328, -216), Vector(-4168, -5440, -222), Vector(-4659, -5201, -224), Vector(-5063, -5186, -224), Vector(-5228, -5296, -224), Vector(-5231, -5562, -224), Vector(-5005, -6496, -48), Vector(-2209, -4638, 0), Vector(-2764, -4824, 0), Vector(-2782, -4132, 0), Vector(-2222, -4567, -124), Vector(-2629, -4096, -320), Vector(-2906, -2018, -384), Vector(-1842, -2139, -640), Vector(-1183, -2761, -640), Vector(-844, -2871, -672), Vector(-196, -2252, -672), Vector(-452, -1483, -640), Vector(-1873, -1686, -640), Vector(488, -1072, -896), Vector(44, -2266, -896), Vector(463, -2963, -896), Vector(123, -3407, -896), Vector(652, -3696, -896), Vector(104, -3699, -896), Vector(-2266, -543, -384), Vector(-3150, -638, -384), Vector(-1798, -730, -384), Vector(-447, -829, 0), Vector(-848, -424, 0), Vector(-448, -282, 0), Vector(-846, -204, 0), Vector(-855, -163, 128), Vector(-449, -440, 128), Vector(-520, -288, 256), Vector(-384, -4992, 176), Vector(-763, -5050, 32), Vector(-769, -4607, 32), Vector(-146, -3205, 523), Vector(-2766, -3379, 0), Vector(-2592, -3551, 0), Vector(-2070, -2217, 0), Vector(-2267, -2538, 0), Vector(-2352, -2932, 0), Vector(-2621, -2530, 0), Vector(-2326, -2640, 144), Vector(-2349, -2911, 128), Vector(-2705, -2636, 128), Vector(-2594, -2633, 128), Vector(-2250, -2222, 128), Vector(-2100, -2216, 134), Vector(-2123, -2219, 166), Vector(-2183, -2417, 134), Vector(-2207, -2416, 166), Vector(-2138, -2418, 166), Vector(-2536, -2616, 256), Vector(-2533, -2214, 256), Vector(-616, 1719, -127), Vector(-460, 1331, -128), Vector(-197, 1721, -128), Vector(199, 1895, -89), Vector(595, 2219, -128), Vector(291, 2645, -128), Vector(7, 2661, -92), Vector(-80, 2663, -85), Vector(-712, 2456, -128), Vector(-8454, 4761, -240), Vector(-8472, 4953, -240), Vector(-8470, 4815, -240), Vector(-8838, 4612, -240), Vector(-8449, 4791, -112), Vector(-5083, 11948, 18), Vector(716, 7019, -256), Vector(1619, 6558, -256), Vector(1431, 6564, -256), Vector(1486, 5815, 16), Vector(1046, 5933, 16), Vector(7134, 5036, -688), Vector(7677, 3333, -688), Vector(7232, 3322, -688), Vector(7808, 3288, -680), Vector(7806, 3465, -680), Vector(8458, 3310, -680), Vector(9091, 3460, -680), Vector(8689, 2798, 256), Vector(8689, 2999, 256), Vector(9437, 11583, -384), Vector(10781, 11590, -384), Vector(10303, 13691, -384), Vector(10282, 14042, -384), Vector(10456, 14024, -384), Vector(10028, 14033, -384), Vector(10190, 14035, -384), Vector(11995, 14016, -512), Vector(12211, 12510, -640), Vector(12093, 12492, -640), Vector(12371, 13879, -672), Vector(13656, 14191, -640), Vector(13673, 13505, -640), Vector(13670, 13208, -640), Vector(14100, 12938, -640), Vector(14101, 12716, -640), Vector(13510, 12114, -640), Vector(13680, 12649, -384), Vector(13679, 12960, -384), Vector(13677, 13552, -384), Vector(14068, 13242, -384), Vector(14054, 12927, -384), Vector(14028, 12615, -384), Vector(13105, 12077, -384), Vector(13089, 12520, -384), Vector(10002, 658, -182), Vector(10208, 670, -182), Vector(10471, 763, -182), Vector(8558, -2210, -512), Vector(8517, -1855, -512), Vector(7894, -2266, -512), Vector(7465, -1828, -512), Vector(7464, -1829, -383), Vector(8499, -1844, -383), Vector(8676, -1850, -383), Vector(8479, -1851, -255), Vector(8730, -2224, -255), Vector(7879, -2237, -255), Vector(7471, -2046, -255), Vector(7880, -1848, -255), Vector(7994, -3491, -504), Vector(8388, -3497, -504), Vector(8382, -3692, -504), Vector(8004, -3650, -504), Vector(8665, -3780, -368), Vector(7490, -3544, -368), Vector(7493, -3715, -240), Vector(7490, -3285, -240), Vector(9006, -3274, -112), Vector(8390, -3293, -112), Vector(7915, -3650, -112), Vector(7483, -3901, -112), Vector(7375, -3589, -112), Vector(8396, -3255, 0), Vector(7984, -3329, 0), Vector(8132, -3243, 0), Vector(10037, -8064, -512), Vector(10488, -8705, -512), Vector(10027, -9222, -512), Vector(9151, -9082, -512), Vector(8947, -8703, -512), Vector(9555, -8065, -512), Vector(10324, -9019, -256), Vector(10487, -8708, -256), Vector(9906, -8140, -256), Vector(9603, -8073, -256), Vector(9133, -8339, -256), Vector(9004, -8690, -256), Vector(9362, -9303, -256), Vector(8896, -8832, 0), Vector(9353, -9357, 0), Vector(9721, -8536, 0), Vector(9727, -8267, 0), Vector(10351, -8366, 0), Vector(9342, -8575, 132), Vector(8988, -8352, 132), Vector(10466, -9056, 132), Vector(9856, -8960, 132), Vector(9856, -10862, -512), Vector(10315, -10752, -512), Vector(8937, -10385, -512), Vector(9170, -11124, -384), Vector(10446, -10408, -384), Vector(10298, -10972, -256), Vector(9040, -11133, 0), Vector(10044, -10405, 0), Vector(10432, -10529, 0), Vector(10176, -10552, 128)}

TotalLoot = TotalLoot or 0
LootMax = 150
weaponLootItems = {}
basicLootItems = {}
function ServerLoad()
    for i = 1, table.Count(DayZItems) do
        if DayZItems[i].LootType == "Basic" then
            table.insert(basicLootItems, i)
        elseif DayZItems[i].LootType == "Weapon" then
            table.insert(weaponLootItems, i)
        end
    end
    SpawnTheLoot()
    timer.Create("spawnLootTimer", 600, 0, function() SpawnTheLoot() end)
end
hook.Add("InitPostEntity", "ServerLoad", ServerLoad)

function SpawnLoot()
    if TotalLoot > LootMax then return end
    local weaponSpawnTable = WeaponLoot[string.lower(game.GetMap())]
    local basicSpawnTable = BasicLoot[string.lower(game.GetMap())]
    for i = 1, table.Count(DayZItems) do
        if DayZItems[i].LootType == "Basic" then
            table.insert(basicLootItems, i)
        elseif DayZItems[i].LootType == "Weapon" then
            table.insert(weaponLootItems, i)
        end
    end
    for i = 1, LootMax do
        spawnType = math.random(1, 2)
        if spawnType == 1 then
            SpawnedItemID = basicLootItems[math.random(1, table.Count(basicLootItems))]
            SpawnPos = basicSpawnTable[math.random(1, table.Count(basicSpawnTable))]
        elseif spawnType == 2 then
            SpawnedItemID = weaponLootItems[math.random(1, table.Count(weaponLootItems))]
            SpawnPos = weaponSpawnTable[math.random(1, table.Count(weaponSpawnTable))]
        end
        for _, ent in pairs(ents.FindInSphere(SpawnPos, 10)) do
            if ent:GetClass() == "base_item" then
                SpawnedItemID = nil
                break
            end
        end
        if (DayZItems[SpawnedItemID] and math.random(0, 100) <= DayZItems[SpawnedItemID].SpawnChance) then spawnItem(SpawnedItemID, SpawnPos) end
    end
end

function SpawnTheLoot() print('[DayZ] Loot before respawn: '..TotalLoot); SpawnLoot(); print('[DayZ] Loot after repsawn: '..TotalLoot) end
concommand.Add("dz_spawnLoot", SpawnTheLoot)

function spawnItem(ItemID, position)
    newItem = ents.Create("base_item")
    newItem.ItemID = ItemID
    newItem:SetPos(position + Vector(0, 0, 5))
    newItem.Amount = 1
    if DayZItems[ItemID].ClipSize then newItem.Amount = DayZItems[ItemID].ClipSize end
    if DayZItems[ItemID].SpawnAngle then newItem:SetAngles(DayZItems[ItemID].SpawnAngle) end
    newItem:Spawn()
    newItem.SpawnLoot = true
    TotalLoot = TotalLoot + 1
    print('[DayZ] ', DayZItems[ItemID].Name, ' (ID: '..ItemID..')')
end